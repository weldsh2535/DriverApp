(window.webpackJsonp=window.webpackJsonp||[]).push([[2,15,16],{"+cje":function(t,e,r){"use strict";r.d(e,"a",function(){return c});var i=r("HDdC"),s=r("XEKg"),n=r("5Jak"),o=r("/GcI"),a=r("cxbk"),d=r("fXoL"),h=r("tk/3");let c=(()=>{class t{constructor(t){this.http=t,this.APIURL=a.a.apiURL}create(t){return this.http.post(this.APIURL+"/restaurant",t)}getAllRestaurant(){return this.http.get(this.APIURL+"/restaurant")}updateRestaurant(t){return this.http.put(this.APIURL+"/restaurant/",t)}removeRestaurant(t){return this.http.delete(this.APIURL+"/restaurant/"+t).toPromise()}handleError(t){return i.a.throw(400===t.status?new s.a(t.json()):404===t.status?new n.a:new o.a(t))}}return t.\u0275fac=function(e){return new(e||t)(d.cc(h.a))},t.\u0275prov=d.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},VNSQ:function(t,e,r){"use strict";r.d(e,"a",function(){return d});var i=r("2Vo4"),s=r("cxbk"),n=r("fXoL"),o=r("tk/3"),a=r("ldse");let d=(()=>{class t{constructor(t,e){this.http=t,this.sharedService=e,this.cart=[],this.cartItemCount=new i.a(0),this.RestaurantId=new i.a({}),this.orderStatus=new i.a({}),this.order=[],this.orderItemCount=new i.a(0),this.APIURL=s.a.apiURL}create(t){return this.http.post(this.APIURL+"/order",t)}getAllOrder(){return this.http.get(this.APIURL+"/order")}getOrderByDate(t){return this.http.get(this.APIURL+"/order/"+t)}updateOrder(t){return this.http.put(this.APIURL+"/order/",t)}removeOrder(t){return this.http.delete(this.APIURL+"/order/"+t).toPromise()}updateOrderStatus(t){return this.http.put(this.APIURL+"/orderstatus/",t)}getCart(){return this.cart}getOrders(){return this.order}getCartItemCount(){return this.cartItemCount}getOrderItemCount(){return this.orderItemCount}getRestaurantId(){return this.RestaurantId}getOrderStatus(){return this.orderStatus}addOrder(t){this.order=[],this.amount=0,this.order.forEach(t=>{let e=this.order.indexOf(e=>e.orderDetailsId===t.orderDetailsId);this.order.splice(e,1)}),this.orderItemCount.next(0),t.forEach(t=>{this.amount=this.amount+t.amount,this.order.push({CookingTime:t.CookingTime,DeliveryTime:t.DeliveryTime,Description:t.Description,Name:t.Name,Price:t.Price,amount:t.amount,categoryId:t.categoryId,id:t.Food,picture:t.picture,restaurantId:t.restaurantId,type:t.type,orderDetailsId:t.orderDetailsId})}),this.orderItemCount.next(this.orderItemCount.value+this.amount)}addProduct(t){let e=!1;for(let r of this.cart)if(r.id===t.id){r.amount+=1,e=!0;break}e||(t.amount=1,this.cart.push(t)),this.cartItemCount.next(this.cartItemCount.value+1)}decreaseProduct(t){for(let[e,r]of this.cart.entries())r.id===t.id&&(r.amount-=1,0==r.amount&&this.cart.splice(e,1));this.cartItemCount.next(this.cartItemCount.value-1)}removeProduct(t){for(let[e,r]of this.cart.entries())r.id===t.id&&(this.cartItemCount.next(this.cartItemCount.value-r.amount),this.cart.splice(e,1))}}return t.\u0275fac=function(e){return new(e||t)(n.cc(o.a),n.cc(a.a))},t.\u0275prov=n.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},ldse:function(t,e,r){"use strict";r.d(e,"a",function(){return n});var i=r("2Vo4"),s=r("fXoL");let n=(()=>{class t{constructor(){this.restaurant=new i.a({}),this.status=new i.a({}),this.location=new i.a({}),this.orderId=new i.a({}),this.RestaurantLocation=new i.a({}),this.resId=new i.a({}),this.listOfCatagoryFilter=new i.a({}),this.deriverId=new i.a({}),this.customerId=new i.a({}),this.customerName=new i.a({})}getMenuFilter(){return this.listOfCatagoryFilter}getLocation(){return this.location}getStatus(){return this.status}getRestaurantLocation(){return this.RestaurantLocation}getRestaurantId(){return this.resId}getDriverId(){return this.deriverId}getCustomerId(){return this.customerId}getCustomerName(){return this.customerName}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=s.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},odG3:function(t,e,r){"use strict";r.r(e),r.d(e,"DriverHistoryPageModule",function(){return D});var i=r("ofXK"),s=r("3Pt+"),n=r("TEn/"),o=r("tyNb"),a=r("mrSG"),d=r("fXoL"),h=r("VNSQ"),c=r("6wYF"),l=r("+cje");const u=["pageTop"];function m(t,e){if(1&t&&(d.Vb(0,"div",16),d.Vb(1,"ion-grid"),d.Vb(2,"ion-row"),d.Vb(3,"ion-label"),d.Ec(4),d.Ub(),d.Ub(),d.Ub(),d.Ub()),2&t){const t=d.ic();d.Eb(4),d.Fc(t.message)}}function g(t,e){if(1&t&&(d.Vb(0,"ion-row",17),d.Vb(1,"ion-col",18),d.Vb(2,"ion-label"),d.Ec(3),d.Vb(4,"p"),d.Ec(5),d.jc(6,"date"),d.Ub(),d.Vb(7,"ion-button",19),d.Ec(8," Delivered "),d.Ub(),d.Ub(),d.Ub(),d.Vb(9,"ion-col",20),d.Vb(10,"ion-label"),d.Ec(11),d.Vb(12,"p"),d.Ec(13),d.Ub(),d.Ub(),d.Vb(14,"p"),d.Ec(15,"Payment"),d.Ub(),d.Vb(16,"ion-label",21),d.Vb(17,"b"),d.Ec(18),d.jc(19,"currency"),d.Ub(),d.Ub(),d.Ub(),d.Ub()),2&t){const t=e.$implicit;d.Eb(3),d.Gc(" ",t.restaurantName," "),d.Eb(2),d.Fc(d.lc(6,5,t.DateTime,"short")),d.Eb(6),d.Gc(" ",t.Customer," "),d.Eb(2),d.Fc(t.PhoneNumber),d.Eb(5),d.Gc(" ",d.lc(19,8,t.Total,"ETB"),"")}}const b=function(t,e){return{"location-visible":t,"location-hidden":e}},f=[{path:"",component:(()=>{class t{constructor(t,e,r,i,s){this.orderService=t,this.accountService=e,this.restaurantService=r,this.datepipe=i,this.loadingController=s,this.listOfOrder=[],this.model={},this.date=new Date,this.showScroll=!1,this.currentMonth=(new Date).getMonth()+1,this.currentYear=(new Date).getFullYear(),this.currentDate=(new Date).getDate(),console.log(this.currentDate),console.log(this.currentMonth),console.log(this.currentYear),console.log((new Date).getDay()),this.restaurantService.getAllRestaurant().subscribe(t=>{this.listOfRestaurant=t})}pageScroller(){this.pageTop.scrollToTop()}ngOnInit(){return Object(a.a)(this,void 0,void 0,function*(){this.loader=yield this.loadingController.create({message:"Getting Products ...",spinner:"bubbles",animated:!0}),yield this.loader.present().then(),this.model.startdate=new Date,this.getOrderByDriverId(),this.getRestaurant(),this.searchdate()})}searchdate(){console.log(this.model.startdate);let t=this.datepipe.transform(this.model.startdate,"yyyy,M,d");function e(t){var e=t.getDate()-t.getDay()+(0===t.getDay()?-6:1);return new Date(t.setDate(e))}function r(t){var e=t.getDate()-(t.getDay()-1)+6;return new Date(t.setDate(e))}var i=new Date(t);function s(t,e){const r=new Date(Number(t));return r.setDate(t.getDate()+e),r}this.startdateofweek=this.datepipe.transform(e(i)),this.startMonth=new Date(this.startdateofweek).getMonth()+1,this.startYear=new Date(this.startdateofweek).getFullYear(),this.startDate=new Date(this.startdateofweek).getDate(),this.Enddateofweek=this.datepipe.transform(r(i)),this.endMonth=new Date(this.Enddateofweek).getMonth()+1,this.endYear=new Date(this.Enddateofweek).getFullYear(),this.endDate=new Date(this.Enddateofweek).getDate();const n=new Date(e(i));this.mon=this.datepipe.transform(e(i),"EEEE, MMMM d"),this.Tuesday=this.datepipe.transform(s(n,1),"EEEE, MMMM d"),this.Wednedday=this.datepipe.transform(s(n,2),"EEEE, MMMM d"),this.Thruds=this.datepipe.transform(s(n,3),"EEEE, MMMM d"),this.Friday=this.datepipe.transform(s(n,4),"EEEE, MMMM d"),this.Sat=this.datepipe.transform(s(n,5),"EEEE, MMMM d"),this.Sun=this.datepipe.transform(r(i),"EEEE, MMMM d")}getRestaurant(){this.restaurantService.getAllRestaurant().subscribe(t=>Object(a.a)(this,void 0,void 0,function*(){yield this.loader.dismiss().then(),this.listOfRestaurant=t}),t=>Object(a.a)(this,void 0,void 0,function*(){yield this.loader.dismiss().then(),console.log(t)}))}getOrderByDriverId(){this.listOfOrder=[];let t=localStorage.getItem("userId");this.orderService.getAllOrder().subscribe(e=>Object(a.a)(this,void 0,void 0,function*(){yield this.loader.dismiss().then();let r=e.filter(e=>e.driver==t);if(r.length>0){let t=r.filter(t=>t.orderStatuses.find(t=>1==t.isChecked&&"delivered"==t.val));t.length>0&&null!=this.listOfRestaurant?t.forEach(t=>{this.accountService.getAllAccount().subscribe(e=>{let r=this.listOfRestaurant.find(e=>e.accountId==+t.restaurantId),i={id:t.id,restaurantName:r.name,DateTime:t.dateTime,Customer:e.find(e=>e.id==+t.customer).fullName,PhoneNumber:e.find(e=>e.id==+t.customer).phonenumber,CLocation:e.find(e=>e.id==+t.customer).locationId,RLocation:t.location,OrderStatus:t.orderStatuses,Total:t.total,Driver:t.driver,Vehicle:t.vehicle,orderLocation:t.orderLocation,restaurantStatus:t.restaurantStatuses};this.listOfOrder.push(i),this.listOfOrder.sort((t,e)=>new Date(e.DateTime).getTime()-new Date(t.DateTime).getTime())})}):this.getRefresh()}else this.massge=!0,this.message="no order history"}),t=>Object(a.a)(this,void 0,void 0,function*(){yield this.loader.dismiss().then(),console.log(t)}))}getRefresh(){setTimeout(()=>{this.getOrderByDriverId()},200)}doRefresh(t){setTimeout(()=>{this.getOrderByDriverId(),t.target.complete()},2e3)}segmentChanged(t){"daily"==t.detail.value?this.scheduleOrder(this.currentDate,"daily"):"week"==t.detail.value?(console.log(t.detail.value),this.scheduleOrder(this.currentWeek,"week")):"month"==t.detail.value?this.scheduleOrder(this.currentMonth,"month"):"year"==t.detail.value&&this.scheduleOrder(this.currentYear,"year")}scheduleOrder(t,e){this.listOfOrder=[];let r=localStorage.getItem("userId");this.orderService.getAllOrder().subscribe(i=>Object(a.a)(this,void 0,void 0,function*(){yield this.loader.dismiss().then();let s=i.filter(t=>t.driver==r);if(s.length>0){let r=s.filter(t=>t.orderStatuses.find(t=>1==t.isChecked&&"delivered"==t.val));r.length>0&&null!=this.listOfRestaurant?r.forEach(r=>{this.accountService.getAllAccount().subscribe(i=>{let s=this.listOfRestaurant.find(t=>t.accountId==+r.restaurantId),n={id:r.id,restaurantName:s.name,DateTime:r.dateTime,Customer:i.find(t=>t.id==+r.customer).fullName,PhoneNumber:i.find(t=>t.id==+r.customer).phonenumber,CLocation:i.find(t=>t.id==+r.customer).locationId,RLocation:r.location,OrderStatus:r.orderStatuses,Total:r.total,Driver:r.driver,Vehicle:r.vehicle,orderLocation:r.orderLocation,restaurantStatus:r.restaurantStatuses};const o=new Date(r.dateTime).getDate();this.orderMonth=new Date(r.dateTime).getMonth()+1,this.orderYear=new Date(r.dateTime).getFullYear(),this.orderDate=new Date(r.dateTime).getDate();const a=new Date(r.dateTime).getMonth()+1,d=new Date(r.dateTime).getFullYear();"daily"==e?(t==o&&(this.listOfOrder.push(n),this.listOfOrder.sort((t,e)=>new Date(e.DateTime).getTime()-new Date(t.DateTime).getTime())),0==this.listOfOrder.length?(this.massge=!0,this.message="no orders in this daily"):this.massge=!1):"week"==e?(this.startDate<=this.orderDate&&this.startMonth==this.orderMonth&&this.startYear==this.orderYear&&this.endDate>=this.orderDate&&this.endMonth==this.orderMonth&&this.endYear==this.orderYear&&(this.listOfOrder.push(n),this.listOfOrder.sort((t,e)=>new Date(e.DateTime).getTime()-new Date(t.DateTime).getTime())),0==this.listOfOrder.length?(this.massge=!0,this.message="no orders in this week"):this.massge=!1):"month"==e?(t==a&&(this.listOfOrder.push(n),this.listOfOrder.sort((t,e)=>new Date(e.DateTime).getTime()-new Date(t.DateTime).getTime())),0==this.listOfOrder.length?(this.massge=!0,this.message="no orders in this month"):this.massge=!1):"year"==e&&(t==d&&(this.listOfOrder.push(n),this.listOfOrder.sort((t,e)=>new Date(e.DateTime).getTime()-new Date(t.DateTime).getTime())),0==this.listOfOrder.length?(this.massge=!0,this.message="no orders in this year"):this.massge=!1)})}):this.getRefresh()}else this.massge=!0,this.message="no order history"}),t=>Object(a.a)(this,void 0,void 0,function*(){yield this.loader.dismiss().then(),console.log(t)}))}onScroll(t){this.showScroll=t.detail.scrollTop>300}}return t.\u0275fac=function(e){return new(e||t)(d.Qb(h.a),d.Qb(c.a),d.Qb(l.a),d.Qb(i.f),d.Qb(n.N))},t.\u0275cmp=d.Kb({type:t,selectors:[["app-driver-history"]],viewQuery:function(t,e){if(1&t&&d.Ic(u,1),2&t){let t;d.uc(t=d.hc())&&(e.pageTop=t.first)}},decls:29,vars:6,consts:[["color","primary"],["slot","start"],["scrollEvents","true",3,"ionScroll"],["pageTop",""],["slot","fixed",3,"ionRefresh"],[3,"ionChange"],["value","daily"],["value","week"],["value","month"],["value","year"],["class","message",4,"ngIf"],[1,"orders"],["class","ion-padding meal-row",4,"ngFor","ngForOf"],["horizontal","end","vertical","bottom","slot","fixed",3,"ngClass"],["color","light",3,"click"],["md","chevron-up-outline","ios","chevron-up-circle-outline"],[1,"message"],[1,"ion-padding","meal-row"],["size","8",1,"border-bottom"],["fill","clear"],["size","4",1,"border-bottom"],["color","dark"]],template:function(t,e){1&t&&(d.Vb(0,"ion-header"),d.Vb(1,"ion-toolbar",0),d.Vb(2,"ion-buttons",1),d.Rb(3,"ion-menu-button"),d.Ub(),d.Vb(4,"ion-title"),d.Ec(5,"Orders history"),d.Ub(),d.Ub(),d.Ub(),d.Vb(6,"ion-content",2,3),d.gc("ionScroll",function(t){return e.onScroll(t)}),d.Vb(8,"ion-refresher",4),d.gc("ionRefresh",function(t){return e.doRefresh(t)}),d.Rb(9,"ion-refresher-content"),d.Ub(),d.Vb(10,"ion-segment",5),d.gc("ionChange",function(t){return e.segmentChanged(t)}),d.Vb(11,"ion-segment-button",6),d.Vb(12,"ion-label"),d.Ec(13,"Daily"),d.Ub(),d.Ub(),d.Vb(14,"ion-segment-button",7),d.Vb(15,"ion-label"),d.Ec(16,"Weekly"),d.Ub(),d.Ub(),d.Vb(17,"ion-segment-button",8),d.Vb(18,"ion-label"),d.Ec(19,"Monthly"),d.Ub(),d.Ub(),d.Vb(20,"ion-segment-button",9),d.Vb(21,"ion-label"),d.Ec(22,"Yearly"),d.Ub(),d.Ub(),d.Ub(),d.Cc(23,m,5,1,"div",10),d.Vb(24,"div",11),d.Cc(25,g,20,11,"ion-row",12),d.Ub(),d.Vb(26,"ion-fab",13),d.Vb(27,"ion-fab-button",14),d.gc("click",function(){return e.pageScroller()}),d.Rb(28,"ion-icon",15),d.Ub(),d.Ub(),d.Ub()),2&t&&(d.Eb(23),d.oc("ngIf",e.massge),d.Eb(2),d.oc("ngForOf",e.listOfOrder),d.Eb(1),d.oc("ngClass",d.sc(3,b,e.showScroll,!e.showScroll)))},directives:[n.p,n.K,n.i,n.x,n.I,n.k,n.z,n.A,n.D,n.R,n.E,n.u,i.n,i.m,n.l,i.l,n.m,n.q,n.o,n.C,n.j,n.h],pipes:[i.f,i.d],styles:[".message[_ngcontent-%COMP%]{padding-top:3px;padding-left:12px;color:#337ab7;font-size:27px}ion-segment[_ngcontent-%COMP%]{padding-left:15px}.location-visible[_ngcontent-%COMP%]{opacity:1;transition:.5s}.location-hidden[_ngcontent-%COMP%]{opacity:0;transition:.5s}ion-segment[_ngcontent-%COMP%]{position:sticky;top:calc(env(safe-area-inset-top) - 0px);z-index:2;background:#eee;box-shadow:0 9px 11px -15px transparent;display:flex;flex-direction:row;align-items:flex-end;border-bottom-right-radius:3px;border-bottom-left-radius:2px}"]}),t})()}];let p=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.Ob({type:t}),t.\u0275inj=d.Nb({imports:[[o.j.forChild(f)],o.j]}),t})(),D=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=d.Ob({type:t}),t.\u0275inj=d.Nb({imports:[[i.c,s.e,n.L,p]]}),t})()}}]);
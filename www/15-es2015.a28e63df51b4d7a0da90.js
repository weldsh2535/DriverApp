(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"+cje":function(t,e,r){"use strict";r.d(e,"a",function(){return d});var o=r("HDdC"),i=r("XEKg"),n=r("5Jak"),s=r("/GcI"),a=r("cxbk"),c=r("fXoL"),u=r("tk/3");let d=(()=>{class t{constructor(t){this.http=t,this.APIURL=a.a.apiURL}create(t){return this.http.post(this.APIURL+"/restaurant",t)}getAllRestaurant(){return this.http.get(this.APIURL+"/restaurant")}updateRestaurant(t){return this.http.put(this.APIURL+"/restaurant/",t)}removeRestaurant(t){return this.http.delete(this.APIURL+"/restaurant/"+t).toPromise()}handleError(t){return o.a.throw(400===t.status?new i.a(t.json()):404===t.status?new n.a:new s.a(t))}}return t.\u0275fac=function(e){return new(e||t)(c.cc(u.a))},t.\u0275prov=c.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},"/GcI":function(t,e,r){"use strict";r.d(e,"a",function(){return o});class o{constructor(t){this.originalError=t}}},"5Jak":function(t,e,r){"use strict";r.d(e,"a",function(){return i});var o=r("/GcI");class i extends o.a{}},VNSQ:function(t,e,r){"use strict";r.d(e,"a",function(){return c});var o=r("2Vo4"),i=r("cxbk"),n=r("fXoL"),s=r("tk/3"),a=r("ldse");let c=(()=>{class t{constructor(t,e){this.http=t,this.sharedService=e,this.cart=[],this.cartItemCount=new o.a(0),this.RestaurantId=new o.a({}),this.orderStatus=new o.a({}),this.order=[],this.orderItemCount=new o.a(0),this.APIURL=i.a.apiURL}create(t){return this.http.post(this.APIURL+"/order",t)}getAllOrder(){return this.http.get(this.APIURL+"/order")}getOrderByDate(t){return this.http.get(this.APIURL+"/order/"+t)}updateOrder(t){return this.http.put(this.APIURL+"/order/",t)}removeOrder(t){return this.http.delete(this.APIURL+"/order/"+t).toPromise()}updateOrderStatus(t){return this.http.put(this.APIURL+"/orderstatus/",t)}getCart(){return this.cart}getOrders(){return this.order}getCartItemCount(){return this.cartItemCount}getOrderItemCount(){return this.orderItemCount}getRestaurantId(){return this.RestaurantId}getOrderStatus(){return this.orderStatus}addOrder(t){this.order=[],this.amount=0,this.order.forEach(t=>{let e=this.order.indexOf(e=>e.orderDetailsId===t.orderDetailsId);this.order.splice(e,1)}),this.orderItemCount.next(0),t.forEach(t=>{this.amount=this.amount+t.amount,this.order.push({CookingTime:t.CookingTime,DeliveryTime:t.DeliveryTime,Description:t.Description,Name:t.Name,Price:t.Price,amount:t.amount,categoryId:t.categoryId,id:t.Food,picture:t.picture,restaurantId:t.restaurantId,type:t.type,orderDetailsId:t.orderDetailsId})}),this.orderItemCount.next(this.orderItemCount.value+this.amount)}addProduct(t){let e=!1;for(let r of this.cart)if(r.id===t.id){r.amount+=1,e=!0;break}e||(t.amount=1,this.cart.push(t)),this.cartItemCount.next(this.cartItemCount.value+1)}decreaseProduct(t){for(let[e,r]of this.cart.entries())r.id===t.id&&(r.amount-=1,0==r.amount&&this.cart.splice(e,1));this.cartItemCount.next(this.cartItemCount.value-1)}removeProduct(t){for(let[e,r]of this.cart.entries())r.id===t.id&&(this.cartItemCount.next(this.cartItemCount.value-r.amount),this.cart.splice(e,1))}}return t.\u0275fac=function(e){return new(e||t)(n.cc(s.a),n.cc(a.a))},t.\u0275prov=n.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},XEKg:function(t,e,r){"use strict";r.d(e,"a",function(){return i});var o=r("/GcI");class i extends o.a{}},ldse:function(t,e,r){"use strict";r.d(e,"a",function(){return n});var o=r("2Vo4"),i=r("fXoL");let n=(()=>{class t{constructor(){this.restaurant=new o.a({}),this.status=new o.a({}),this.location=new o.a({}),this.orderId=new o.a({}),this.RestaurantLocation=new o.a({}),this.resId=new o.a({}),this.listOfCatagoryFilter=new o.a({}),this.deriverId=new o.a({}),this.customerId=new o.a({}),this.customerName=new o.a({})}getMenuFilter(){return this.listOfCatagoryFilter}getLocation(){return this.location}getStatus(){return this.status}getRestaurantLocation(){return this.RestaurantLocation}getRestaurantId(){return this.resId}getDriverId(){return this.deriverId}getCustomerId(){return this.customerId}getCustomerName(){return this.customerName}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=i.Mb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},"piv+":function(t,e,r){"use strict";r.r(e),r.d(e,"OrderHistoryPageModule",function(){return I});var o=r("ofXK"),i=r("3Pt+"),n=r("TEn/"),s=r("tyNb"),a=r("mrSG"),c=r("fXoL"),u=r("VNSQ"),d=r("+cje"),h=r("8D9V"),l=r("Dkj+"),b=r("ldse");function m(t,e){if(1&t&&(c.Vb(0,"ion-badge"),c.Ec(1),c.jc(2,"async"),c.Ub()),2&t){const t=c.ic();c.Eb(1),c.Fc(c.kc(2,1,t.cartItemCount))}}function g(t,e){if(1&t&&(c.Vb(0,"ion-item",13),c.Vb(1,"ion-grid"),c.Vb(2,"ion-row",14),c.Vb(3,"ion-col",15),c.Vb(4,"ion-button",16),c.Rb(5,"ion-icon",17),c.Ub(),c.Ub(),c.Vb(6,"ion-col",18),c.Ec(7),c.Ub(),c.Vb(8,"ion-col",15),c.Vb(9,"ion-button",16),c.Rb(10,"ion-icon",19),c.Ub(),c.Ub(),c.Vb(11,"ion-col",20),c.Vb(12,"ion-button",16),c.Rb(13,"ion-icon",21),c.Ub(),c.Ub(),c.Ub(),c.Vb(14,"ion-row"),c.Vb(15,"ion-col",22),c.Vb(16,"b"),c.Ec(17),c.Ub(),c.Ub(),c.Vb(18,"ion-col",23),c.Vb(19,"b"),c.Ec(20),c.jc(21,"currency"),c.Ub(),c.Ub(),c.Vb(22,"ion-col",12),c.Ec(23),c.jc(24,"currency"),c.Ub(),c.Ub(),c.Ub(),c.Ub()),2&t){const t=e.$implicit;c.Eb(7),c.Gc(" ",t.amount," "),c.Eb(10),c.Fc(t.Name),c.Eb(3),c.Fc(c.lc(21,4,t.Price,"ETB")),c.Eb(3),c.Gc(" ",c.lc(24,7,t.amount*t.Price,"ETB")," ")}}const f=[{path:"",component:(()=>{class t{constructor(t,e,r,o,i,n,s,a,c){this.modalCtrl=t,this.alertCtrl=e,this.orderService=r,this.fb=o,this.router=i,this.restaurantService=n,this.orderDetailService=s,this.foodService=a,this.sharedService=c,this.cart=[],this.regform=this.fb.group({}),this.currentDate=(new Date).toUTCString(),this.minDate=(new Date).toISOString(),this.maxDate=(new Date).toISOString()}ngOnInit(){this.regform=this.fb.group({transactionType:[""],DeliveryDate:[""],DeliveryTime:[""],DeliveryAddress:[""]});let t=new Date;t.setDate(t.getDate()-5),this.minDate=t.toISOString(),t=new Date,t.setDate(t.getDate()+5),this.maxDate=t.toISOString(),this.cart=this.orderService.getOrders(),this.status=this.sharedService.getStatus().value,console.log(this.status),this.cartItemCount=this.orderService.getOrderItemCount(),this.id=this.orderService.getRestaurantId().value,this.getRestaurant(),this.getFood(),this.readNOId()}getRestaurant(){this.restaurantService.getAllRestaurant().subscribe(t=>{this.listOfRestaurant=t})}getFood(){this.foodService.getAllFood().subscribe(t=>{this.listOfFood=t})}readNOId(){let t=0;this.orderService.getAllOrder().subscribe(e=>{t=0==e.length?1:e.length+1,this.orderNo=+t})}decreaseCartItem(t){this.orderService.decreaseProduct(t)}increaseCartItem(t){this.orderService.addProduct(t)}removeCartItem(t){this.presentAlertConfirm(t)}getTotal(){return this.cart.reduce((t,e)=>t+e.amount*e.Price,0)}close(){this.modalCtrl.dismiss()}order(t){this.Total=0,t.forEach(t=>{this.restaurantId=t.restaurantId,this.Total=this.Total+t.Price*t.amount,this.orderDetailService.create({OrderId:this.orderNo,Restaurant:t.restaurantId,Food:t.id,Qty:t.amount,Price:t.Price})});let e={DateTime:this.regform.get("DeliveryDate").value,Customer:localStorage.getItem("userId"),Location:this.listOfRestaurant.find(t=>t.id==this.restaurantId).location,OrderStatus:this.regform.get("transactionType").value,Total:this.Total,orderNo:this.orderNo,Driver:null,Vehicle:null,orderLocation:null};this.orderService.create(e)}presentAlertConfirm(t){return Object(a.a)(this,void 0,void 0,function*(){const e=yield this.alertCtrl.create({header:"Clear cart !",message:"<strong>Are you sure you want to remove all items in your cart ?</strong>",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:t=>{console.log("Confirm Cancel: blah")}},{text:"OK",handler:()=>{this.orderService.removeProduct(t)}}]});yield e.present()})}backPage(){this.router.navigate("driver"==this.status?["/menu/driver-home"]:"restaurant-home"==this.status?["/menu/restaurant-home"]:"restaurant-history"==this.status?["/menu/restaurant-history"]:["/menu/order"])}}return t.\u0275fac=function(e){return new(e||t)(c.Qb(n.O),c.Qb(n.a),c.Qb(u.a),c.Qb(i.b),c.Qb(s.g),c.Qb(d.a),c.Qb(h.a),c.Qb(l.a),c.Qb(b.a))},t.\u0275cmp=c.Kb({type:t,selectors:[["app-order-history"]],decls:23,vars:6,consts:[["color","light"],["slot","start"],["fill","solid","shape","round","color","light",3,"click"],["slot","icon-only","name","arrow-back","color","primary"],[2,"text-align","center"],["slot","end"],[4,"ngIf"],["slot","icon-only","name","cart",1,"cart-icon"],["fullscreen",""],[1,"ion-padding"],["class","ion-text-wrap",4,"ngFor","ngForOf"],["size","9"],["size","3",1,"ion-text-end"],[1,"ion-text-wrap"],[1,"ion-align-items-center"],["size","2",1,"ion-align-self-center"],["color","medium","fill","clear"],["name","remove-circle","slot","icon-only"],["size","1",1,"ion-align-self-center"],["name","add-circle","slot","icon-only"],["size","2","offset","5"],["name","close-circle","slot","icon-only"],["size","5"],["size","4"]],template:function(t,e){1&t&&(c.Vb(0,"ion-header"),c.Vb(1,"ion-toolbar",0),c.Vb(2,"ion-buttons",1),c.Vb(3,"ion-button",2),c.gc("click",function(){return e.backPage()}),c.Rb(4,"ion-icon",3),c.Ub(),c.Ub(),c.Vb(5,"ion-title",4),c.Ec(6,"Detail orders"),c.Ub(),c.Vb(7,"ion-buttons",5),c.Vb(8,"ion-button"),c.Cc(9,m,3,3,"ion-badge",6),c.Rb(10,"ion-icon",7),c.Ub(),c.Ub(),c.Ub(),c.Ub(),c.Vb(11,"ion-content",8),c.Vb(12,"div",9),c.Vb(13,"ion-list"),c.Cc(14,g,25,10,"ion-item",10),c.Vb(15,"ion-item"),c.Vb(16,"ion-grid"),c.Vb(17,"ion-row"),c.Vb(18,"ion-col",11),c.Ec(19," Total: "),c.Ub(),c.Vb(20,"ion-col",12),c.Ec(21),c.jc(22,"currency"),c.Ub(),c.Ub(),c.Ub(),c.Ub(),c.Ub(),c.Ub(),c.Ub()),2&t&&(c.Eb(9),c.oc("ngIf",e.cart.length>0),c.Eb(5),c.oc("ngForOf",e.cart),c.Eb(7),c.Gc(" ",c.lc(22,3,e.getTotal(),"ETB")," "))},directives:[n.p,n.K,n.i,n.h,n.q,n.I,o.n,n.k,n.v,o.m,n.t,n.o,n.C,n.j,n.g],pipes:[o.d,o.b],styles:["ion-badge[_ngcontent-%COMP%]{color:#fff;position:absolute;top:-9px;right:2px;border-radius:100%}.cart-icon[_ngcontent-%COMP%]{font-size:50px}.cart-length[_ngcontent-%COMP%]{color:var(--ion-color-primary);position:absolute;top:18px;left:25px;font-weight:600;font-size:1em;min-width:25px;z-index:10}"]}),t})()}];let p=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.Ob({type:t}),t.\u0275inj=c.Nb({imports:[[s.j.forChild(f)],s.j]}),t})(),I=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.Ob({type:t}),t.\u0275inj=c.Nb({imports:[[o.c,i.e,n.L,p,i.m]]}),t})()}}]);